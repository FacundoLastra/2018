<html>

<head>
    <title>Tp4 Facundo Lastra</title>
    <meta charset="UTF-8">
</head>

<body>
    <main>
        <div id="app">
            <h1>Super listado de personas</h1>

            <p v-if="errors.length">
                <b>Por favor, corriga los siguientes error(es):</b>
                <ul>
                    <li v-for="error in errors">{{ error }}</li>
                </ul>
            </p>
            <section>
                <input type="text" v-model="persona.nombre" placeholder="Ingresar nombre de persona">
                <span v-if="!persona.nombre">*Requerido*</span>
                <div>
                    <div>
                        <input type="radio" v-model="persona.sexo" value="Masculino" id="masculino">
                        <label for="masculino">Masculino</label>
                    </div>
                    <div>
                        <input type="radio" v-model="persona.sexo" value="Femenino" id="femenino">
                        <label for="femenino">Femenino</label>
                    </div>
                    <div>
                        <input type="radio" v-model="persona.sexo" value="Otro" id="otro">
                        <label for="otro">otro</label>
                    </div>
                    <span v-if="!persona.sexo">*Requerido*</span>
                </div>
                <input type="number" v-model="persona.edad" placeholder="edad">
                <span v-if="!persona.edad">*Requerido*</span>

                <button @click="agregar()">Agregar</button>
            </section>
            <section>
                <h2>Â¿Como desea visualizar?</h2>
                <select name="options" v-model="filtro">
                    <option value="todos" selected>Todos</option>
                    <option value="Masculino">Masculino</option>
                    <option value="Femenino">Femenino</option>
                    <option value="Otro">Otro</option>
                </select>

                <ul>
                    <li v-for="persona in getPersons" :key="persona.id">
                        <a @click="borrarPersona(persona.id)">{{ persona.nombre }} - {{ persona.sexo}} -
                            {{persona.edad}}</a>
                    </li>
                </ul>
                <h3>Hay {{total}} persona/s</h3>
            </section>
        </div>
    </main>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script>
        const instancia1 = new Vue({
            el: "#app",
            data: {
                idInicial: 0,
                filtro: "todos",
                personas: [],
                persona: {
                    nombre: "",
                    sexo: "",
                    edad: ""
                },
                errors: [],
                totalPersons: 0
            },
            computed: {
                total() {
                    return this.totalPersons;
                },
                getPersons: function () {
                    let personsfiltred;
                    if (this.filtro == "todos") {
                        personsfiltred = this.personas;
                    } else {
                        personsfiltred = this.personas.filter(persona => persona.sexo === this.filtro)
                    }
                    this.totalPersons = personsfiltred.length;
                    return personsfiltred;
                }
            },
            methods: {
                agregar() {
                    if (this.validarForm()) {
                        this.personas.push({
                            id: this.idInicial++,
                            nombre: this.persona.nombre,
                            sexo: this.persona.sexo,
                            edad: this.persona.edad
                        });
                        this.persona.nombre = "";
                        this.persona.sexo = "";
                        this.persona.edad = "";
                    }
                },
                borrarPersona(id) {
                    this.personas = this.personas.filter(persona => persona.id !== id);
                },
                validarForm() {
                    this.errors = [];
                    if (this.persona.nombre && this.persona.edad && this.persona.edad > 0 && this.persona.edad < 200 && this.persona.sexo) {
                        return true;
                    }
                    if (!this.persona.nombre) {
                        this.errors.push("Nombre debe contener datos")
                    }
                    if (!this.persona.edad) {
                        this.errors.push("Edad debe contener un numero")
                    } else if (this.persona.edad < 0) {
                        this.errors.push("La edad no puede ser negativa")
                    } else {
                        this.errors.push("La edad supera el limite permitido")
                    }
                    if (!this.persona.sexo) {
                        this.errors.push("Debe seleccionar un sexo")
                    }
                }
            }
        });
    </script>
</body>

</html>